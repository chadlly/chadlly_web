<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<title>코스만들기상세페이지</title>
	<link href="../layout/styles/index.css" rel="stylesheet" type="text/css">
	<link href="../layout/styles/filter_detail_page.css" rel="stylesheet" type="text/css">
</head>
<script src="//code.jquery.com/jquery-3.3.1.min.js"></script>

<body>
	<div id="container">
		<div class="nav">
			<div class="nav-left-items">
				<img src="../images/logo.png" width="300px" height="50px">
			</div>
			<div class="nav-right-items">
                <div class="nav-item">
                    <a href="../index.html">홈으로</a>
                </div>
                <div class="nav-item">
                    <a href="../index.html">코스 계획하기</a>
                </div>
                <div class="nav-item">
                    <a href="filter.html">코스 필터하기</a>
                </div>
                <div class="nav-item">
                    <a href="../index.html">추천 코스보기</a>
                </div>
			</div>
		</div>

		<div id="map">

		</div>

		<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=2c32bcbd6cb55928dc1395f28a59aeec"></script>
		<script>
			var mapContainer = document.getElementById('map'), // 지도를 표시할 div
				mapOption = {
					center: new kakao.maps.LatLng(37.56691, 126.98017), // 지도의 중심좌표
					level: 4, // 지도의 확대 레벨
					mapTypeId: kakao.maps.MapTypeId.ROADMAP // 지도종류
				};
			var map = new kakao.maps.Map(mapContainer, mapOption);
		</script>

		<div class="contents">
			<div class="content-descriptions">
				<div class="content-description">
					출발 지점 :
				</div>
				<div class="content-description">
					목적지 1 :
				</div>
				<div class="content-description">
					목적지 2 :
				</div>
				<div class="content-description">
					목적지 3 :
				</div>
				<div class="content-description">
					주요 장소 :
				</div>
				<div class="content-description">
					비용 :
				</div>
			</div>

			<div class="sub-contents">
				<!-- <div class="parking">
					주변주차장 검색 ->
					<label><input type="radio" name="parking" value="on" > on </label>
					<label><input type="radio" name="parking" value="off" checked> off </label>
				</div> -->


				<div class="wrap">
	    <form name="reviewform" class="reviewform" method="post" action="/save">
	        <input type="hidden" name="rate" id="rate" value="0"/>
	        <div class="title_star">별점과 리뷰를 남겨주세요.</div>

	        <div class="review_rating">
	            <div class="rating">
	                <!-- 해당 별점을 클릭하면 해당 별과 그 왼쪽의 모든 별의 체크박스에 checked 적용 -->
	                <input type="checkbox" name="rating" id="rating1" value="1" class="rate_radio" title="1점">
	                <label for="rating1"></label>
	                <input type="checkbox" name="rating" id="rating2" value="2" class="rate_radio" title="2점">
	                <label for="rating2"></label>
	                <input type="checkbox" name="rating" id="rating3" value="3" class="rate_radio" title="3점" >
	                <label for="rating3"></label>
	                <input type="checkbox" name="rating" id="rating4" value="4" class="rate_radio" title="4점">
	                <label for="rating4"></label>
	                <input type="checkbox" name="rating" id="rating5" value="5" class="rate_radio" title="5점">
	                <label for="rating5"></label>
	            </div>
	        </div>
	        <div class="review_contents">
	            <textarea class="review_textarea" form="review" cols="40" rows="5" autofocus required wrap="hard" placeholder="후기를 입력하세요"></textarea>

				  </div>
					<div class="cmd">
							<input type="button" name="save" id="save" value="등록">
					</div>
	    </form>
	</div>

	<script type="text/javascript">
	function Rating(){};
Rating.prototype.rate = 0;
Rating.prototype.setRate = function(newrate){
	//별점 마킹 - 클릭한 별 이하 모든 별 체크 처리
	this.rate = newrate;
	let items = document.querySelectorAll('.rate_radio');
	items.forEach(function(item, idx){
			if(idx < newrate){
					item.checked = true;
			}else{
					item.checked = false;
			}
	});
}
let rating = new Rating();//별점 인스턴스 생성

document.addEventListener('DOMContentLoaded', function(){
    //별점선택 이벤트 리스너
    document.querySelector('.rating').addEventListener('click',function(e){
        let elem = e.target;
        if(elem.classList.contains('rate_radio')){
            rating.setRate(parseInt(elem.value));
        }
    })
});

//상품평 작성 글자수 초과 체크 이벤트 리스너
	 document.querySelector('.review_textarea').addEventListener('keydown',function(){
			 //리뷰 400자 초과 안되게 자동 자름
			 let review = document.querySelector('.review_textarea');
			 let lengthCheckEx = /^.{400,}$/;
			 if(lengthCheckEx.test(review.value)){
					 //400자 초과 컷
					 review.value = review.value.substr(0,400);
			 }
	 });

	 //저장 전송전 필드 체크 이벤트 리스너
	 document.querySelector('#save').addEventListener('click', function(e){
			 //별점 선택 안했으면 메시지 표시
			 if(rating.rate == 0){
					 rating.showMessage('rate');
					 return false;
			 }
			 //리뷰 5자 미만이면 메시지 표시
			 if(document.querySelector('.review_textarea').value.length < 5){
					 rating.showMessage('review');
					 return false;
			 }
			 //폼 서밋
	 });
	 Rating.prototype.showMessage = function(type){//경고메시지 표시
    switch(type){
        case 'rate':
            //안내메시지 표시
            document.querySelector('.review_rating .warning_msg').style.display = 'block';
            //지정된 시간 후 안내 메시지 감춤
            setTimeout(function(){
                document.querySelector('.review_rating .warning_msg').style.display = 'none';
            },1000);
            break;
        case 'review':
            //안내메시지 표시
            document.querySelector('.review_contents .warning_msg').style.display = 'block';
            //지정된 시간 후 안내 메시지 감춤
            setTimeout(function(){
                document.querySelector('.review_contents .warning_msg').style.display = 'none';
            },1000);
            break;
    }
}
	</script>

			</div>
		</div>
	</div>
</body>
